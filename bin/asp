#! /usr/bin/env ruby
# coding: utf-8

require_relative '../lib/ansible_spec_plus'
require_relative '../lib/helpers/log'

# require 'ansible_spec_plus'

include Helpers::Log

# defaults
DEFAULT_OPTS = {
}
options = DEFAULT_OPTS.clone

KNOWN_RESOURCES = [
  'file',
  'template',
  'docker_container',
  'docker_image',
  'service'
]

def help_message
  STDOUT.puts <<-EOF
  Ansible Spec Plus is an addon to 'ansible_spec' which enables you to run
  specs for Ansible roles, hosts and/or playbooks separately. Furthermore
  it provides you with a simple resource coverage summary.

  Usage:
  asp all                                          # list all available specs
  asp [rolespec|hostspec|playbookspec] list        # list all available role/host/playbook specs
  EOF
end

case ARGV[0]
when "rolespec"
  case ARGV[1]
  when "list"
    options[:role_spec_list] = true
  else
    options[:role_spec_run] = ARGV[1]
  end
else
  help_message
end

begin
  AnsibleSpecPlus.new(
    options
  )
rescue => e
  raise e
end
